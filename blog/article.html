<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="pageTitle">Article - WaiWai.diy</title>
    <meta name="description" id="pageDescription" content="">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/marked@4.0.0/marked.min.js"></script>
    <link href="../css/normalize.css" rel="stylesheet" type="text/css">
    <link href="../css/webflow.css" rel="stylesheet" type="text/css">
    <link href="../css/waiwaidiy.webflow.css" rel="stylesheet" type="text/css">
</head>
<body class="bg-gray-900 text-white">
    <nav class="bg-gray-800 border-b border-gray-700">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center">
                    <a href="/" class="text-xl font-bold">WaiWai.diy</a>
                </div>
                <div>
                    <a href="/#blog-posts" class="text-gray-300 hover:text-white px-3 py-2">
                        Back to Blog
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <main class="max-w-4xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
        <article>
            <header class="mb-8">
                <img id="articleImage" src="" alt="" class="w-full h-64 object-cover rounded-lg mb-8">
                <h1 id="articleTitle" class="text-4xl font-bold mb-4"></h1>
                <div id="articleMeta" class="text-gray-400"></div>
            </header>
            <div id="articleContent" class="prose prose-invert max-w-none">
                <!-- Article content will be inserted here -->
            </div>
        </article>
    </main>

    <script type="module">
        import { supabase } from '../js/supabase.js';
        import { marked } from 'https://cdn.jsdelivr.net/npm/marked/lib/marked.esm.js';

        // Get article slug from URL
        const slug = window.location.pathname.split('/').pop();

        // Load article
        const loadArticle = async () => {
            const { data: article, error } = await supabase
                .from('articles')
                .select('*')
                .eq('slug', slug)
                .eq('is_published', true)
                .single();

            if (error) {
                console.error('Error loading article:', error);
                return;
            }

            if (!article) {
                window.location.href = '/';
                return;
            }

            // Update page metadata
            document.getElementById('pageTitle').textContent = article.seo_title || article.title;
            document.getElementById('pageDescription').content = article.seo_description;

            // Update article content
            document.getElementById('articleTitle').textContent = article.title;
            document.getElementById('articleImage').src = supabase.storage
                .from('article-images')
                .getPublicUrl(article.image_path)
                .data.publicUrl;
            document.getElementById('articleImage').alt = article.title;
            document.getElementById('articleMeta').textContent = new Date(article.created_at).toLocaleDateString();
            document.getElementById('articleContent').innerHTML = marked.parse(article.content);
        };

        // Load article when the page loads
        loadArticle();
    </script>

    <style>
        /* Add Tailwind Typography styles for markdown content */
        .prose {
            color: #e5e7eb;
            max-width: 65ch;
            margin: 0 auto;
        }
        .prose h1, .prose h2, .prose h3, .prose h4 {
            color: white;
            margin-top: 2em;
            margin-bottom: 1em;
        }
        .prose p {
            margin-top: 1.25em;
            margin-bottom: 1.25em;
        }
        .prose a {
            color: #818cf8;
            text-decoration: underline;
        }
        .prose strong {
            color: white;
        }
        .prose ul, .prose ol {
            margin-top: 1.25em;
            margin-bottom: 1.25em;
            padding-left: 1.625em;
        }
        .prose li {
            margin-top: 0.5em;
            margin-bottom: 0.5em;
        }
        .prose blockquote {
            border-left: 4px solid #4b5563;
            padding-left: 1em;
            color: #9ca3af;
        }
        .prose code {
            color: #e5e7eb;
            background-color: #374151;
            padding: 0.2em 0.4em;
            border-radius: 0.25em;
        }
        .prose pre {
            background-color: #1f2937;
            padding: 1em;
            border-radius: 0.375em;
            overflow-x: auto;
        }
    </style>
</body>
</html> 